(function(e){function t(t){for(var n,i,l=t[0],s=t[1],o=t[2],u=0,d=[];u<l.length;u++)i=l[u],Object.prototype.hasOwnProperty.call(c,i)&&c[i]&&d.push(c[i][0]),c[i]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);b&&b(t);while(d.length)d.shift()();return r.push.apply(r,o||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],n=!0,l=1;l<a.length;l++){var s=a[l];0!==c[s]&&(n=!1)}n&&(r.splice(t--,1),e=i(i.s=a[0]))}return e}var n={},c={app:0},r=[];function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=n,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(a,n,function(t){return e[t]}.bind(null,n));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/Alignment_of_99/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],s=l.push.bind(l);l.push=t,l=l.slice();for(var o=0;o<l.length;o++)t(l[o]);var b=s;r.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"2dc0":function(e,t,a){"use strict";a("bff8")},"467d":function(e,t,a){},"46a6":function(e,t,a){"use strict";a("467d")},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("7a23"),c={class:"navbar navbar-light bg-white fixed-top"},r={class:"container-fluid"},i=Object(n["g"])("img",{src:"/Alignment_of_99/favicon.ico",alt:"LOGO",style:{width:"30px"}},null,-1),l={key:0},s=Object(n["g"])("div",null,null,-1),o={style:{"padding-top":"75px"}};function b(e,t,a,b,u,d){var p=Object(n["A"])("router-link"),O=Object(n["A"])("router-view");return Object(n["t"])(),Object(n["f"])(n["a"],null,[Object(n["g"])("header",null,[Object(n["g"])("nav",c,[Object(n["g"])("div",r,[Object(n["i"])(p,{class:"navbar-brand",to:"/",style:{"font-family":"'Noto Serif TC', serif"}},{default:Object(n["G"])((function(){return[i,Object(n["h"])(Object(n["C"])(e.Title),1)]})),_:1}),"undefined"!=typeof e.$route.params.time?(Object(n["t"])(),Object(n["f"])("span",l,"房間編號："+Object(n["C"])(e.$route.params.time),1)):Object(n["e"])("",!0)]),s])]),Object(n["g"])("div",o,[Object(n["i"])(O)])],64)}var u={data:function(){return{Title:"陣營九九"}}};a("46a6");u.render=b;var d=u,p=(a("7b17"),a("ab8b"),a("6c02")),O={class:"index"};function h(e,t,a,c,r,i){var l=Object(n["A"])("Index");return Object(n["t"])(),Object(n["f"])("div",O,[r.login?(Object(n["t"])(),Object(n["d"])(l,{key:0})):Object(n["e"])("",!0)])}a("4de4"),a("b0c0");Object(n["w"])("data-v-c6b2d30a");var j={class:"Index row"},y={class:"chatroom"},f={class:"col-12",style:{"font-size":"12pt"}},m={class:"sticky-top",style:{"background-color":"#45a173"}},v={key:0},g={key:1},k=Object(n["h"])(),w=["onsubmit"],x=Object(n["g"])("button",{type:"submit",class:"btn btn-primary d-inlineblock",style:{width:"50px",padding:"3px","font-size":"0.8rem"}}," 傳送 ",-1),D={style:{"font-size":"0.5rem","margin-right":"0.3rem"}},C={key:0,class:"layout"},S={class:" container"},L={class:"row",style:{height:"3rem","margin-top":"3.5rem"}},P={class:"col-12",style:{position:"relative","justify-content":"center",display:"flex"}},M={style:{width:"12rem",position:"relative"}},A=Object(n["g"])("div",{class:"back"},null,-1),z=[A],H={class:"col-12"},_={class:"col-12",style:{position:"relative",height:"4rem",overflow:"hidden"}},G=Object(n["g"])("div",{class:"back"},null,-1),I=[G],N={class:"col-12"},E={class:"col-12",style:{position:"relative",height:"4rem",overflow:"hidden"}},$=Object(n["g"])("div",{class:"back"},null,-1),V=[$],B={class:"col-12"},R={class:"col-12",style:{position:"relative",height:"4rem",overflow:"hidden"}},T=Object(n["g"])("div",{class:"back"},null,-1),U=[T],J={key:3,class:"row d-md-none justify-content-between"},X={class:"col-12"},Y={class:"col-12",style:{position:"relative",height:"4rem",overflow:"hidden"}},Z=Object(n["g"])("div",{class:"back"},null,-1),F=[Z],K={key:4,class:"row d-md-none justify-content-between"},Q={class:"col-12"},q={class:"col-12",style:{position:"relative",height:"4rem",overflow:"hidden"}},W=Object(n["g"])("div",{class:"back"},null,-1),ee=[W],te={key:5,class:"row d-md-none justify-content-between"},ae={class:"col-12"},ne={class:"col-12",style:{position:"relative",height:"4rem",overflow:"hidden"}},ce=Object(n["g"])("div",{class:"back"},null,-1),re=[ce],ie={class:"text-center"},le=Object(n["g"])("img",{src:"/img/clockwise.png",alt:"",style:{height:"60px"}},null,-1),se=[le],oe={key:0,class:"col-12"},be={style:{position:"relative",height:"6rem"}},ue={key:1},de={class:"row"},pe={class:"row align-items-center"},Oe={key:0,class:"col-12"},he=["disabled"],je={key:1,class:"btn-group align-items-center",role:"group"},ye=["onClick","disabled"],fe={key:2,style:{"margin-right":"1rem"}},me={key:1,class:"col-12"},ve=Object(n["g"])("h5",null,"不是你的回合。",-1),ge=[ve],ke={key:2,class:"col-12"},we={key:7,type:"button",class:"btn btn-danger","data-bs-toggle":"modal","data-bs-target":"#giveupModal"},xe={class:"modal fade",id:"giveupModal",tabindex:"-1","aria-labelledby":"giveupModalLabel","aria-hidden":"true"},De={class:"modal-dialog modal-sm"},Ce={class:"modal-content"},Se=Object(n["g"])("div",{class:"modal-header"},[Object(n["g"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Le=Object(n["g"])("div",{class:"modal-body"},"是否確定投降？",-1),Pe={class:"modal-footer"},Me=Object(n["g"])("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1),Ae={key:1,class:"layout"},ze={class:"container"};function He(e,t,a,c,r,i){var l=Object(n["A"])("card");return Object(n["t"])(),Object(n["f"])("div",j,[Object(n["g"])("div",y,[Object(n["g"])("div",f,[Object(n["g"])("div",m,[Object(n["g"])("h5",null,[e.watcher?(Object(n["t"])(),Object(n["f"])("span",v,"觀戰者")):(Object(n["t"])(),Object(n["f"])("span",g,Object(n["C"])(e.playername),1)),k,Object(n["g"])("span",{class:"d-inlineblock d-lg-none",style:{float:"right",cursor:"pointer"},onClick:t[0]||(t[0]=function(e){return i.changeChatroom()})},"x")]),Object(n["g"])("form",{onsubmit:i.sendMessage},[Object(n["H"])(Object(n["g"])("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=function(t){return e.text=t}),style:{width:"calc(100% - 60px)"}},null,512),[[n["E"],e.text]]),x],8,w)]),(Object(n["t"])(!0),Object(n["f"])(n["a"],null,Object(n["z"])(e.chatroomMessages,(function(e){return Object(n["t"])(),Object(n["f"])("div",{key:e,style:{}},[Object(n["g"])("span",D,Object(n["C"])(e.timestamp),1),Object(n["h"])(Object(n["C"])(e.user)+"："+Object(n["C"])(e.text),1)])})),128))])]),0==e.gameover?(Object(n["t"])(),Object(n["f"])("div",C,[Object(n["g"])("div",S,[Object(n["g"])("span",{class:"sticky-top d-inlineblock d-lg-none",style:{"background-color":"white",height:"1rem",width:"1rem",cursor:"pointer","z-index":"500"},onClick:t[2]||(t[2]=function(e){return i.changeChatroom()})},"訊息>"),Object(n["g"])("div",L,[Object(n["g"])("div",P,[Object(n["g"])("div",M,[(Object(n["t"])(!0),Object(n["f"])(n["a"],null,Object(n["z"])(e.publicData.deckLength,(function(e){return Object(n["t"])(),Object(n["f"])("div",{class:"card",key:e,style:Object(n["p"])({transform:"translate("+(3+-.01*e)+"rem , "+-.01*e+"rem)"})},z,4)})),128)),(Object(n["t"])(!0),Object(n["f"])(n["a"],null,Object(n["z"])(e.deadwoodcards,(function(e,t){return Object(n["t"])(),Object(n["d"])(l,{key:e,rank:e.rank,suit:e.suit,class:Object(n["o"])(e.chose),style:Object(n["p"])({transform:"translate("+(9+-.01*t)+"rem , "+-.01*t+"rem)"})},null,8,["rank","suit","class","style"])})),128))])])]),0!=e.playerList?(Object(n["t"])(),Object(n["f"])("div",{key:0,class:Object(n["o"])(["row",{"d-none d-lg-flex":e.playerList.length>4}])},[(Object(n["t"])(!0),Object(n["f"])(n["a"],null,Object(n["z"])(e.playerList,(function(t){return Object(n["t"])(),Object(n["f"])("div",{class:"col playerState",key:t},[Object(n["g"])("div",{class:Object(n["o"])(["row",{playerActive:e.publicData.player[e.publicData.number]==t}]),style:{position:"relative"}},[Object(n["g"])("div",H,[Object(n["g"])("div",null,Object(n["C"])(t),1),Object(n["g"])("div",null,Object(n["C"])(e.publicData.playerState[t].role),1)]),Object(n["g"])("div",_,[(Object(n["t"])(!0),Object(n["f"])(n["a"],null,Object(n["z"])(e.publicData.playerState[t].handLength,(function(e){return Object(n["t"])(),Object(n["f"])("div",{class:"card",key:e,style:Object(n["p"])({transform:"translate("+(2.5+.5*e)+"rem,    3rem)"})},I,4)})),128))])],2)])})),128))],2)):Object(n["e"])("",!0),0!=e.playerList&e.playerList.length>4?(Object(n["t"])(),Object(n["f"])("div",{key:1,class:Object(n["o"])(["row d-lg-none justify-content-between",{"d-none d-md-flex":e.playerList.length>6}])},[(Object(n["t"])(!0),Object(n["f"])(n["a"],null,Object(n["z"])(e.playerList.filter((function(t,a){return a>0&a<e.playerList.length-1})),(function(t){return Object(n["t"])(),Object(n["f"])("div",{class:"col playerState",key:t},[Object(n["g"])("div",{class:Object(n["o"])(["row",{playerActive:e.publicData.player[e.publicData.number]==t}]),style:{position:"relative"}},[Object(n["g"])("div",N,[Object(n["g"])("div",null,Object(n["C"])(t),1),Object(n["g"])("div",null,Object(n["C"])(e.publicData.playerState[t].role),1)]),Object(n["g"])("div",E,[(Object(n["t"])(!0),Object(n["f"])(n["a"],null,Object(n["z"])(e.publicData.playerState[t].handLength,(function(e){return Object(n["t"])(),Object(n["f"])("div",{class:"card",key:e,style:Object(n["p"])({transform:"translate("+(2.5+.5*e)+"rem,    3rem)"})},V,4)})),128))])],2)])})),128))],2)):Object(n["e"])("",!0),0!=e.playerList&e.playerList.length>4?(Object(n["t"])(),Object(n["f"])("div",{key:2,class:Object(n["o"])(["row d-lg-none justify-content-between",{"d-none d-md-flex":e.playerList.length>6}])},[(Object(n["t"])(!0),Object(n["f"])(n["a"],null,Object(n["z"])(e.playerList.filter((function(t,a){return 0==a|a==e.playerList.length-1})),(function(t){return Object(n["t"])(),Object(n["f"])("div",{class:"col playerState",key:t},[Object(n["g"])("div",{class:Object(n["o"])(["row",{playerActive:e.publicData.player[e.publicData.number]==t}]),style:{position:"relative"}},[Object(n["g"])("div",B,[Object(n["g"])("div",null,Object(n["C"])(t),1),Object(n["g"])("div",null,Object(n["C"])(e.publicData.playerState[t].role),1)]),Object(n["g"])("div",R,[(Object(n["t"])(!0),Object(n["f"])(n["a"],null,Object(n["z"])(e.publicData.playerState[t].handLength,(function(e){return Object(n["t"])(),Object(n["f"])("div",{class:"card",key:e,style:Object(n["p"])({transform:"translate("+(2.5+.5*e)+"rem,    3rem)"})},U,4)})),128))])],2)])})),128))],2)):Object(n["e"])("",!0),0!=e.playerList&e.playerList.length>6?(Object(n["t"])(),Object(n["f"])("div",J,[(Object(n["t"])(!0),Object(n["f"])(n["a"],null,Object(n["z"])(e.playerList.filter((function(t,a){return a>1&a<e.playerList.length-2})),(function(t){return Object(n["t"])(),Object(n["f"])("div",{class:"col playerState",key:t},[Object(n["g"])("div",{class:Object(n["o"])(["row",{playerActive:e.publicData.player[e.publicData.number]==t}]),style:{position:"relative"}},[Object(n["g"])("div",X,[Object(n["g"])("div",null,Object(n["C"])(t),1),Object(n["g"])("div",null,Object(n["C"])(e.publicData.playerState[t].role),1)]),Object(n["g"])("div",Y,[(Object(n["t"])(!0),Object(n["f"])(n["a"],null,Object(n["z"])(e.publicData.playerState[t].handLength,(function(e){return Object(n["t"])(),Object(n["f"])("div",{class:"card",key:e,style:Object(n["p"])({transform:"translate("+(2.5+.5*e)+"rem,    3rem)"})},F,4)})),128))])],2)])})),128))])):Object(n["e"])("",!0),0!=e.playerList&e.playerList.length>6?(Object(n["t"])(),Object(n["f"])("div",K,[(Object(n["t"])(!0),Object(n["f"])(n["a"],null,Object(n["z"])(e.playerList.filter((function(t,a){return 1==a|a==e.playerList.length-2})),(function(t){return Object(n["t"])(),Object(n["f"])("div",{class:"col playerState",key:t},[Object(n["g"])("div",{class:Object(n["o"])(["row",{playerActive:e.publicData.player[e.publicData.number]==t}]),style:{position:"relative"}},[Object(n["g"])("div",Q,[Object(n["g"])("div",null,Object(n["C"])(t),1),Object(n["g"])("div",null,Object(n["C"])(e.publicData.playerState[t].role),1)]),Object(n["g"])("div",q,[(Object(n["t"])(!0),Object(n["f"])(n["a"],null,Object(n["z"])(e.publicData.playerState[t].handLength,(function(e){return Object(n["t"])(),Object(n["f"])("div",{class:"card",key:e,style:Object(n["p"])({transform:"translate("+(2.5+.5*e)+"rem,    3rem)"})},ee,4)})),128))])],2)])})),128))])):Object(n["e"])("",!0),0!=e.playerList&e.playerList.length>6?(Object(n["t"])(),Object(n["f"])("div",te,[(Object(n["t"])(!0),Object(n["f"])(n["a"],null,Object(n["z"])(e.playerList.filter((function(t,a){return 0==a|a==e.playerList.length-1})),(function(t){return Object(n["t"])(),Object(n["f"])("div",{class:"col playerState",key:t},[Object(n["g"])("div",{class:Object(n["o"])(["row",{playerActive:e.publicData.player[e.publicData.number]==t}]),style:{position:"relative"}},[Object(n["g"])("div",ae,[Object(n["g"])("div",null,Object(n["C"])(t),1),Object(n["g"])("div",null,Object(n["C"])(e.publicData.playerState[t].role),1)]),Object(n["g"])("div",ne,[(Object(n["t"])(!0),Object(n["f"])(n["a"],null,Object(n["z"])(e.publicData.playerState[t].handLength,(function(e){return Object(n["t"])(),Object(n["f"])("div",{class:"card",key:e,style:Object(n["p"])({transform:"translate("+(2.5+.5*e)+"rem,    3rem)"})},re,4)})),128))])],2)])})),128))])):Object(n["e"])("",!0),Object(n["g"])("div",null,[Object(n["g"])("p",ie,[Object(n["g"])("span",{class:Object(n["o"])(["counterclockwise",{active:e.publicData.order}])},se,2)])]),0!=e.publicData?(Object(n["t"])(),Object(n["f"])("div",{key:6,class:Object(n["o"])(["row",{playerActive:e.publicData.player[e.publicData.number]==e.playername}])},[e.alive?(Object(n["t"])(),Object(n["f"])("div",oe,[Object(n["g"])("div",be,[(Object(n["t"])(!0),Object(n["f"])(n["a"],null,Object(n["z"])(e.cardParse,(function(e,t){return Object(n["t"])(),Object(n["d"])(l,{key:e,onUpdate:function(t){return i.chooseCard(e)},rank:e.rank,suit:e.suit,class:Object(n["o"])(e.chose),style:Object(n["p"])({transform:"translate("+(15*t+135)+"px , 3rem)"})},null,8,["onUpdate","rank","suit","class","style"])})),128))])])):(Object(n["t"])(),Object(n["f"])("h4",ue,"你輸了")),Object(n["g"])("div",null,Object(n["C"])(e.playername),1),Object(n["g"])("div",null,Object(n["C"])(e.role),1),Object(n["g"])("div",null," 現在點數："+Object(n["C"])(e.publicData.point)+"、已選取點數："+Object(n["C"])(i.chosepoint),1)],2)):Object(n["e"])("",!0),Object(n["g"])("div",de,[Object(n["g"])("h5",null,Object(n["C"])(e.message),1)]),Object(n["g"])("div",pe,[e.myturn&!e.watcher?(Object(n["t"])(),Object(n["f"])("div",Oe,[0==i.playOptionView?(Object(n["t"])(),Object(n["f"])("button",{key:0,class:"btn btn-secondary",disabled:i.playSituation,onClick:t[3]||(t[3]=function(e){return i.play()})},Object(n["C"])(i.ability),9,he)):(Object(n["t"])(),Object(n["f"])("div",je,[(Object(n["t"])(!0),Object(n["f"])(n["a"],null,Object(n["z"])(i.playOptionView.selections,(function(e){return Object(n["t"])(),Object(n["f"])("button",{key:e,class:"btn btn-secondary",onClick:function(t){return i.play(e.name)},disabled:e.disabled},Object(n["C"])(e.name),9,ye)})),128))])),i.playOptionView?(Object(n["t"])(),Object(n["f"])("label",fe,Object(n["C"])(i.playOptionView.ability),1)):Object(n["e"])("",!0)])):(Object(n["t"])(),Object(n["f"])("div",me,ge)),e.watcher?(Object(n["t"])(),Object(n["f"])("div",ke,"正處於觀戰者模式")):Object(n["e"])("",!0)]),e.myturn&!e.watcher?(Object(n["t"])(),Object(n["f"])("button",we," 投降 ")):Object(n["e"])("",!0),Object(n["g"])("div",xe,[Object(n["g"])("div",De,[Object(n["g"])("div",Ce,[Se,Le,Object(n["g"])("div",Pe,[Me,Object(n["g"])("button",{type:"button",class:"btn btn-danger","data-bs-dismiss":"modal",onClick:t[4]||(t[4]=function(e){return i.giveup()})}," 投降 ")])])])])])])):(Object(n["t"])(),Object(n["f"])("div",Ae,[Object(n["g"])("div",ze,[Object(n["g"])("span",{class:"sticky-top d-inlineblock d-lg-none",style:{"background-color":"white",height:"1rem",width:"1rem",cursor:"pointer","z-index":"500"},onClick:t[5]||(t[5]=function(e){return i.changeChatroom()})},"訊息>"),Object(n["g"])("button",{type:"button",class:"btn btn-primary",onClick:t[6]||(t[6]=function(e){return i.restart()})}," 重開一局 "),Object(n["g"])("h5",null,"遊戲結束，"+Object(n["C"])(e.winner)+"陣營勝利。",1),(Object(n["t"])(!0),Object(n["f"])(n["a"],null,Object(n["z"])(e.publicData.playerState,(function(e,t){return Object(n["t"])(),Object(n["f"])("h5",{key:e},Object(n["C"])(t)+"、陣營為"+Object(n["C"])(e.role),1)})),128))])]))])}Object(n["u"])();var _e=a("1da1"),Ge=(a("96cf"),a("a434"),a("d81d"),a("99af"),a("d3b7"),a("3ca3"),a("ddb0"),Object(n["g"])("div",{class:"face"},null,-1)),Ie=[Ge];function Ne(e,t,a,c,r,i){return Object(n["t"])(),Object(n["f"])("div",{class:Object(n["o"])(["card",a.suit+" rank"+a.rank]),onClick:t[0]||(t[0]=function(e){return i.choosecard()})},Ie,2)}var Ee={name:"card",data:function(){return{height:0}},props:["rank","suit"],methods:{choosecard:function(){this.$emit("update",!0)}}};Ee.render=Ne;var $e=Ee,Ve=a("d4ec"),Be=a("bee2"),Re=(a("159b"),a("a630"),a("260b")),Te=(a("ea7b"),a("e71f"),a("66ce"),{apiKey:"AIzaSyAIHirmV1sv79CgVkSNeXZZOu1nfQ6fgtI",authDomain:"alignment99-bef9a.firebaseapp.com",databaseURL:"https://alignment99-bef9a-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"alignment99-bef9a",storageBucket:"alignment99-bef9a.appspot.com",messagingSenderId:"338869000934",appId:"1:338869000934:web:b20c83d09625dd9ed5b927",measurementId:"G-TP8Y0HYEPX"});Re["a"].initializeApp(Te);var Ue=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();Object(Ve["a"])(this,e),this.time=t}return Object(Be["a"])(e,[{key:"connectDb",value:function(){var e=this,t="data/"+this.time+"/";return Re["a"].database().ref(t).once("value",(function(t){e.data=t.val(),e.data.public.deadwood="undefined"==typeof e.data.public.deadwood?[]:e.data.public.deadwood,e.data.public.player.forEach((function(t){e.data.private.playerHand[t]="undefined"==typeof e.data.private.playerHand[t]?[]:e.data.private.playerHand[t]}))}))}},{key:"connectMsgDb",value:function(){var e=this;return Re["a"].database().ref("messages/"+this.time+"/").once("value",(function(t){null==t.val()?e.msglength=0:e.msglength=t.val().length}))}},{key:"newGame",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["Alice","Bob","Cat","Dobby","Elise","Fox","Gary","Hank"],a=2;this.data={public:{player:t,playerState:{},point:99,order:!0,number:Math.floor(Math.random()*t.length),deadwood:[],deckLength:52+a-5*t.length,gameover:!1},private:{playerHand:{},deck:this.setDeck(a),playerState:{}}};var n=this.roleGenerate();this.data.public.player.forEach((function(t){e.data.private.playerHand[t]=[],e.draw(t,5),e.data.private.playerState[t]={role:n.pop()},e.data.public.playerState[t]={handLength:5,role:"unknown",alive:!0}}));var c={};return c[this.time]=this.data,c}},{key:"update",value:function(e,t){t.public.deckLength=t.private.deck.length,t.public.player.forEach((function(e){t.public.playerState[e].handLength=t.private.playerHand[e].length,t.public.playerState[e].role=t.public.playerState[e].alive?"unknown":t.private.playerState[e].role})),this.checkGameover(),Re["a"].database().ref(e).update(t)}},{key:"checkGameover",value:function(){var e=this,t=this.data.public.player.map((function(t){return e.data.private.playerState[t].role})).filter((function(t,a){return e.data.public.playerState[e.data.public.player[a]].alive}));-1==t.indexOf("Red")|-1==t.indexOf("Black")&&(this.data.public.gameover=!0,this.data.public.player.forEach((function(t){e.data.public.playerState[t].handLength=e.data.private.playerHand[t].length,e.data.public.playerState[t].role=e.data.private.playerState[t].role})),-1==t.indexOf("Joker")?-1==t.indexOf("Red")?-1==t.indexOf("Black")?this.data.public.winner="None":this.data.public.winner="Black":this.data.public.winner="Red":this.data.public.winner="Joker",this.sendSystemMsg("遊戲結束"))}},{key:"roleGenerate",value:function(){var e=[],t=this.data.public.player.length;e.push("Joker");for(var a=0;a<(t-1)/2;a++)e.push("Red"),e.push("Black");return Xe(e)}},{key:"draw",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=0;a<t;a++)this.data.private.playerHand[e].push(this.data.private.deck.pop()),0==this.data.private.deck.length&&(this.data.private.deck=this.data.public.deadwood,this.data.public.deadwood=[])}},{key:"play",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:NaN;if(t.length>0&t.length<3){var n=this.data.private.playerHand[e],c="data/"+this.time+"/",r=t.map((function(e){return Ye(e,!0)}));2==r.length?(Array.prototype.push.apply(this.data.public.deadwood,r),r.forEach((function(e){n.splice(n.indexOf(e),1)}))):(this.data.public.deadwood.push(r[0]),n.splice(n.indexOf(r[0]),1));var i=this.chosePoint(t),l="",s="";switch(i){case"joker":l+=a+"的陣營是"+this.data.private.playerState[a].role+"；",this.draw(e),this.nextPlayer(),s=e+"檢查了"+a+"的陣營";break;case 4:this.data.public.order=!this.data.public.order,this.draw(e),this.nextPlayer(),s="迴轉";break;case 5:this.data.public.number=this.data.public.player.indexOf(a),this.draw(e),s="指定輪到"+a+"的回合";break;case 7:var o=this.data.private.playerHand[e];this.data.private.playerHand[e]=this.data.private.playerHand[a],this.data.private.playerHand[a]=o,s=e+"和"+a+"交換所有手牌",0==this.data.private.playerHand[a].length&&(this.data.public.playerState[a].alive=!1,s+="，"+a+"死亡"),this.nextPlayer();break;case 9:this.data.private.playerHand[e].push(this.data.private.playerHand[a].pop()),s=e+"抽走"+a+"一張手牌",0==this.data.private.playerHand[a].length&&(this.data.public.playerState[a].alive=!1,s+="，"+a+"死亡"),this.nextPlayer();break;case 10:"+10"==a?this.data.public.point+=10:this.data.public.point-=10,this.draw(e),this.nextPlayer();break;case 11:this.draw(e),this.draw(e),this.nextPlayer();break;case 12:"+20"==a?this.data.public.point+=20:this.data.public.point-=20,this.draw(e),this.nextPlayer();break;case 13:this.data.public.point=99,this.draw(e),this.nextPlayer();break;default:this.data.public.point+=i,this.draw(e),this.nextPlayer();break}return this.update(c,this.data),this.sendSystemMsg(s),l}}},{key:"sendSystemMsg",value:function(e){var t;""!=e&&(t={user:"系統",text:e,timestamp:Ze()},Re["a"].database().ref("messages/"+this.time+"/"+this.msglength+"/").update(t))}},{key:"giveup",value:function(e){this.nextPlayer(),this.data.public.playerState[e].alive=!1,Array.prototype.push.apply(this.data.public.deadwood,this.data.private.playerHand[e]),this.data.private.playerHand[e]=[];var t="data/"+this.time+"/";this.sendSystemMsg(e+"已經投降了"),this.update(t,this.data)}},{key:"nextPlayer",value:function(){var e=this,t=Array.from(this.data.public.player.keys()).filter((function(t){return e.data.public.playerState[e.data.public.player[t]].alive}));this.data.public.order?this.data.public.number=t.indexOf(this.data.public.number)==t.length-1?t[0]:t[t.indexOf(this.data.public.number)+1]:this.data.public.number=0==t.indexOf(this.data.public.number)?t[t.length-1]:t[t.indexOf(this.data.public.number)-1]}},{key:"chosePoint",value:function(e){var t=0;return 1==e.length?t="joker"==e[0].suit?"joker":e[0].rank:2==e.length&&(t=Math.abs(e[0].rank-e[1].rank)),t}},{key:"setDeck",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=t?Xe(Array.from(Array(52+e).keys())):Array.from(Array(52+e).keys());return a}}]),e}();function Je(e){var t=0;return 1==e.length?t="joker"==e[0].suit?"joker":e[0].rank:2==e.length&&(t=Math.abs(e[0].rank-e[1].rank)),t}function Xe(e){var t,a=[];while(e.length)t=Math.floor(Math.random()*e.length),a.push(e[t]),e.splice(t,1);return a}function Ye(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=["spades","hearts","clubs","diamonds","joker"];return t?e.rank+13*a.indexOf(e.suit)-1:{rank:e%13+1,suit:a[parseInt(e/13)]}}function Ze(){var e=new Date,t=e.getHours(),a=e.getMinutes();return"".concat(t,":").concat(a)}var Fe={name:"Index",components:{card:$e},data:function(){return{chosecards:[],playername:null,playerList:!1,publicData:!1,cards:[],deadwoodcards:[],message:"",myturn:!1,alive:!0,role:null,cardParse:[],gameover:!1,winner:null,watcher:!1,chatroomMessages:[],text:""}},created:function(){var e=this,t="data/"+this.$route.params.time+"/";Re["a"].database().ref(t+"public/").once("value",(function(t){e.publicData=t.val(),"undefined"==typeof e.$route.params.user?(e.playername=e.publicData.player[e.publicData.number],e.watcher=!0):e.playername=e.publicData.player[e.$route.params.user],e.playerList=e.publicData.player,e.playerList=e.playerList.splice(e.playerList.indexOf(e.playername)).splice(1),Array.prototype.push.apply(e.playerList,e.publicData.player),e.playerList=e.playerList.reverse()})).then((function(){Re["a"].database().ref(t+"public/").on("value",(function(t){e.publicData=t.val(),e.myturn=e.publicData.player[e.publicData.number]==e.playername,e.alive=e.publicData.playerState[e.playername].alive,e.gameover=e.publicData.gameover,e.gameover&&(e.winner=e.publicData.winner),e.deadwoodcards="undefined"==typeof e.publicData.deadwood?[]:e.publicData.deadwood.map((function(e){return Ye(e)}))})),Re["a"].database().ref(t+"private/").on("value",(function(t){e.cards="undefined"==typeof t.val().playerHand[e.playername]?[]:t.val().playerHand[e.playername],e.cardParse=e.cards.map((function(e){return Ye(e)})),e.chosecards=[],e.role=t.val().playerState[e.playername].role})),Re["a"].database().ref("messages/"+e.$route.params.time+"/").on("value",(function(t){var a=t.val();e.chatroomMessages=a.reverse()}))}))},computed:{chosepoint:function(){return Je(this.chosecards)},ability:function(){var e={4:"迴轉",11:"抽2張",13:"99!"};return e[this.chosepoint]?e[this.chosepoint]:"打牌"},playSituation:function(){if(1==this.chosecards.length){if(-1!=[4,5,7,9,10,11,12,13].indexOf(this.chosecards[0].rank)|"joker"==this.chosepoint)return!1;if(this.chosecards[0].rank+this.publicData.point<=99)return!1}else if(2==this.chosecards.length&&-1!=[4,5,7,9,10,11,12,13].indexOf(Math.abs(this.chosecards[0].rank-this.chosecards[1].rank)))return!1;return!0},playOptionPlayers:function(){var e=this;return this.publicData.player.map((function(t){return{name:t,disabled:t==e.playername|!e.publicData.playerState[t].alive}}))},playOptionView:function(){switch(this.chosepoint){case 5:return{ability:"指定一名玩家從他開始",selections:this.playOptionPlayers};case 7:return{ability:"指定一名玩家交換所有手牌",selections:this.playOptionPlayers};case 9:return{ability:"指定一名玩家抽一張手牌",selections:this.playOptionPlayers};case 10:return{ability:"將點數+10或-10",selections:[{name:"+10",disabled:this.publicData.point+10>99},{name:"-10",disabled:this.publicData.point-10<0}]};case 12:return{ability:"將點數+20或-20",selections:[{name:"+20",disabled:this.publicData.point+20>99},{name:"-20",disabled:this.publicData.point-20<0}]};case"joker":return{ability:"指定一名玩家知道他的身分",selections:this.playOptionPlayers};default:return!1}}},methods:{changeChatroom:function(){-1!=document.getElementsByClassName("chatroom")[0].className.indexOf("active")?document.getElementsByClassName("chatroom")[0].className="chatroom":document.getElementsByClassName("chatroom")[0].className="chatroom active"},getTime:function(){var e=new Date,t=e.getHours(),a=e.getMinutes();return"".concat(t,":").concat(a)},sendMessage:function(){var e,t;return e=null==this.chatroomMessages?0:this.chatroomMessages.length,""!=this.text&&(t=this.watcher?{user:"觀戰者",text:this.text,timestamp:this.getTime()}:{user:this.playername,text:this.text,timestamp:this.getTime()},this.text="",Re["a"].database().ref("messages/"+this.$route.params.time+"/"+e+"/").update(t)),!1},restart:function(){var e=this.$route.params.time,t=new Ue(e),a=t.newGame(this.publicData.player);Re["a"].database().ref("data").update(a)},giveup:function(){var e=this;function t(e){return a.apply(this,arguments)}function a(){return a=Object(_e["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=new Ue(t),e.next=3,Promise.all([a.connectDb(),a.connectMsgDb()]);case 3:return e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)}))),a.apply(this,arguments)}t(this.$route.params.time).then((function(t){t.giveup(e.playername)}))},play:function(e){var t=this;function a(e){return n.apply(this,arguments)}function n(){return n=Object(_e["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=new Ue(t),e.next=3,Promise.all([a.connectDb(),a.connectMsgDb()]);case 3:return e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)}))),n.apply(this,arguments)}a(this.$route.params.time).then((function(a){var n=a.play(t.playername,t.chosecards,e);t.chosecards=[],t.message+=n}))},chooseCard:function(e){"chose"==e.chose?(this.chosecards.splice(this.chosecards.indexOf(e),1),e.chose=""):this.chosecards.length<2&&0==this.chosecards.length|"joker"!=e.suit&"joker"!=this.chosepoint&&(this.chosecards.push(e),e.chose="chose")}},mounted:function(){}};a("2dc0");Fe.render=He,Fe.__scopeId="data-v-c6b2d30a";var Ke=Fe,Qe={name:"index",components:{Index:Ke},data:function(){return{login:!0}},created:function(){-1!=document.cookie.indexOf("Align99")&&(this.login=!0)}};Qe.render=h;var qe=Qe,We={class:"index"};function et(e,t,a,c,r,i){var l=Object(n["A"])("Index");return Object(n["t"])(),Object(n["f"])("div",We,[Object(n["i"])(l)])}Object(n["w"])("data-v-692b8c75");var tt={class:"Index"},at={class:"container"},nt=Object(n["g"])("button",{class:"btn btn-primary",type:"button","data-bs-toggle":"modal","data-bs-target":"#newgameModal"}," 新遊戲 ",-1),ct={class:"table"},rt=Object(n["g"])("thead",null,[Object(n["g"])("th"),Object(n["g"])("th",null,"現有遊戲列表"),Object(n["g"])("th",null,"狀態"),Object(n["g"])("th",null,"玩家")],-1),it=Object(n["h"])("刪除"),lt={key:0},st={key:1},ot={class:"modal fade",id:"newgameModal",tabindex:"-1","aria-labelledby":"newgameModalLabel","aria-hidden":"true"},bt={class:"modal-dialog"},ut={class:"modal-content"},dt=Object(n["g"])("div",{class:"modal-header"},[Object(n["g"])("h5",{class:"modal-title"},"新遊戲"),Object(n["g"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),pt={class:"modal-body"},Ot=Object(n["g"])("label",{for:"playerName",class:"form-label mb3"},"輸入玩家名稱",-1),ht=["onUpdate:modelValue","placeholder"],jt=Object(n["g"])("div",{class:"modal-footer justify-content-between"},[Object(n["g"])("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 "),Object(n["g"])("button",{type:"submit",class:"btn btn-primary"},"送出")],-1);function yt(e,t,a,c,r,i){var l=Object(n["A"])("router-link");return Object(n["t"])(),Object(n["f"])(n["a"],null,[Object(n["g"])("div",tt,[Object(n["g"])("div",at,[nt,Object(n["g"])("table",ct,[rt,Object(n["g"])("tbody",null,[(Object(n["t"])(!0),Object(n["f"])(n["a"],null,Object(n["z"])(e.list,(function(t,a){return Object(n["t"])(),Object(n["f"])("tr",{key:t},[Object(n["g"])("td",null,[Object(n["i"])(l,{to:"#",onClick:function(e){return i.deleteGame(t)}},{default:Object(n["G"])((function(){return[it]})),_:2},1032,["onClick"])]),Object(n["g"])("td",null,[Object(n["i"])(l,{to:{name:"game",params:{time:t}},target:"_blank"},{default:Object(n["G"])((function(){return[Object(n["h"])(Object(n["C"])(t),1)]})),_:2},1032,["to"])]),e.state[a]?(Object(n["t"])(),Object(n["f"])("td",st,"已結束")):(Object(n["t"])(),Object(n["f"])("td",lt,"進行中")),Object(n["g"])("td",null,[(Object(n["t"])(!0),Object(n["f"])(n["a"],null,Object(n["z"])(e.players[a],(function(e,a){return Object(n["t"])(),Object(n["d"])(l,{to:{name:"gameUser",params:{time:t,user:a}},key:e,target:"_blank"},{default:Object(n["G"])((function(){return[Object(n["h"])(Object(n["C"])(e),1)]})),_:2},1032,["to"])})),128))])])})),128))])])])]),Object(n["g"])("div",ot,[Object(n["g"])("div",bt,[Object(n["g"])("div",ut,[dt,Object(n["g"])("form",{onSubmit:t[0]||(t[0]=function(t){return i.newGame(e.newPlayerList)})},[Object(n["g"])("div",pt,[Ot,(Object(n["t"])(),Object(n["f"])(n["a"],null,Object(n["z"])(10,(function(t){return Object(n["H"])(Object(n["g"])("input",{type:"text",class:"form-control playerName",key:t,"onUpdate:modelValue":function(a){return e.newPlayerList[t-1]=a},placeholder:t+"號玩家"},null,8,ht),[[n["E"],e.newPlayerList[t-1]]])})),64)),Object(n["g"])("p",null,Object(n["C"])(e.errormessage),1)]),jt],32)])])])],64)}Object(n["u"])();a("b64b"),a("07ac");var ft={name:"Index",data:function(){return{game:null,list:[],state:[],players:[],newPlayerList:[],errormessage:null}},created:function(){var e=this,t="data/";Re["a"].database().ref(t).on("value",(function(t){var a=t.val();e.list=Object.keys(t.val()),e.state=Object.keys(t.val()).map((function(e){return a[e].public.gameover})),e.players=Object.keys(t.val()).map((function(e){return a[e].public.player}))}))},methods:{newGame:function(e){if(Object.values(e).length<=2)return this.errormessage="至少需要三名玩家",!1;this.game=new Ue;var t=this.game.newGame(Object.values(e));return Re["a"].database().ref("data").update(t),!0},deleteGame:function(e){Re["a"].database().ref("data/"+e).remove()}},mounted:function(){}};a("a015");ft.render=yt,ft.__scopeId="data-v-692b8c75";var mt=ft,vt={name:"index",components:{Index:mt}};vt.render=et;var gt=vt,kt={class:"index"};function wt(e,t,a,c,r,i){var l=Object(n["A"])("Api",!0);return Object(n["t"])(),Object(n["f"])("div",kt,[Object(n["i"])(l)])}var xt={class:"api"};function Dt(e,t,a,c,r,i){return Object(n["t"])(),Object(n["f"])("div",xt)}var Ct={name:"api",created:function(){var e=new Ue,t=e.newGame(),a=Re["a"].database().ref("data").update(t);console.log(a)}};Ct.render=Dt;var St=Ct,Lt={name:"api",components:{Api:St}};Lt.render=wt;var Pt=Lt,Mt=[{path:"/game/:time/",name:"game",component:qe},{path:"/game/:time/:user",name:"gameUser",component:qe},{path:"/admin",name:"admin",component:gt},{path:"/",name:"index",component:gt},{path:"/api/",name:"api",component:Pt}],At=Object(p["a"])({history:Object(p["b"])("/Alignment_of_99/"),routes:Mt}),zt=At;a("e5bd");Object(n["c"])(d).use(zt).mount("#app")},a015:function(e,t,a){"use strict";a("fadf")},bff8:function(e,t,a){},e5bd:function(e,t,a){},fadf:function(e,t,a){}});
//# sourceMappingURL=app.2cda7a21.js.map